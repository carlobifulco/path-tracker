// Generated by CoffeeScript 1.3.3
(function() {
  var get_all, get_checked, get_unchecked, parse_html, post_data, render, render_template, show_paths,
    __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; },
    _this = this;

  window.get_checked = get_checked = function(id) {
    var checked_boxes, i, _i, _len, _results;
    checked_boxes = $("#" + id + " input[type='checkbox']:checked");
    _results = [];
    for (_i = 0, _len = checked_boxes.length; _i < _len; _i++) {
      i = checked_boxes[_i];
      _results.push($(i).attr("name"));
    }
    return _results;
  };

  window.get_checked = get_checked;

  window.get_all = get_all = function(id) {
    var all_boxes, i, _i, _len, _results;
    all_boxes = $("#" + id + " input[type='checkbox']");
    _results = [];
    for (_i = 0, _len = all_boxes.length; _i < _len; _i++) {
      i = all_boxes[_i];
      _results.push($(i).attr("name"));
    }
    return _results;
  };

  window.get_all = get_all;

  window.get_unchecked = get_unchecked = function(id) {
    var i, _i, _len, _ref, _results;
    _ref = get_all(id);
    _results = [];
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      i = _ref[_i];
      if (__indexOf.call(get_checked(id), i) < 0) {
        _results.push(i);
      }
    }
    return _results;
  };

  window.get_unchecked = get_unchecked;

  window.parse_html = parse_html = function() {
    var data;
    return data = {
      path_present: _.union(get_checked("working"), get_unchecked("absent")),
      path_absent: _.union(get_checked("absent"), get_unchecked("working"))
    };
  };

  render = function(data, html) {
    var hb, results;
    if (typeof data === "string") {
      data = JSON.parse(data);
      console.log(data);
    }
    hb = Handlebars.compile(html);
    results = hb(data);
    return results;
  };

  window.render = render;

  render_template = function(id, data) {
    var hook, rendered_template;
    rendered_template = render(data, ($("#" + id + "_template")[0]).innerHTML);
    console.log(rendered_template);
    hook = $("#" + id + "_html");
    if (hook.length === 0) {
      console.log("NO HOOCK");
    }
    return $("#" + id + "_html").html(rendered_template);
  };

  window.render_template = render_template;

  post_data = function() {
    var data;
    data = parse_html();
    window.data = data;
    return $.post("/setup/1", data, function(e) {
      if (JSON.parse(e)) {
        show_paths();
        alert("Data Updated");
        return console.log(e);
      }
    });
  };

  window.post_data = post_data;

  window.show_paths = show_paths = function() {
    return $.get("/get_setup/1", function(e) {
      var absent, data, working;
      window.data = data = JSON.parse(e);
      window.working = working = {
        pathologist_working: data.pathologist_working
      };
      render_template("working", working);
      window.absent = absent = {
        pathologist_absent: data.pathologist_absent
      };
      return render_template("absent", absent);
    });
  };

  $(document).ready(function() {
    console.log("here I am");
    show_paths();
    return $("#ajax_button").click(function(e) {
      console.log("click");
      return post_data();
    });
  });

}).call(this);
